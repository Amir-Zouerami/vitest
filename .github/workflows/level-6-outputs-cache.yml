name: level 7 (envs and secrets)

on:
    workflow_dispatch:

    push:
        branches:
            - main
            - 'dev-*'
            - 'feat/**'
        paths-ignore: '.github/workflows/*'

env:
    DB_USERNAME: ${{ secrets.DB_USERNAME }}
    DB_PASSWORD: ${{ secrets.DB_PASSWORD }}

jobs:
    display-the-env:
        runs-on: ubuntu-latest

        steps:
            - name: checkout source code
              uses: actions/checkout@v4

            - name: cache dependencies
              uses: actions/cache@v4
              with:
                  path: ~/.npm
                  key: deps-node-modules-${{ hashFiles('**/package-lock.json') }}

            - name: install dependencies
              run: npm ci

            - name: run test.js
              run: node test.js

            - name: access ENV secrets straight from action
              run: echo ${{ env.DB_USERNAME }} ${{ env.DB_PASSWORD }}
